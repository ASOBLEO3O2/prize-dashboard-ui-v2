/* =========================================
   Widget①: 売上 / ステーション 構成比（2重ドーナツ）
   - 左: ドーナツ（canvas）
   - 右: ABC（凡例）
   ========================================= */

.widget1{
  height:100%;
  min-height:0;
  display:flex;
  flex-direction:column;
}

/* header（左：タイトル / 右：拡大 + ドロップダウン） */
.widget1Header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  padding:10px 10px 0;
  min-height:0;
}

.widget1HeaderLeft{
  display:flex;
  align-items:center;
  gap:10px;
  min-width:0;
}

.widget1Title{
  font-weight:900;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

.widget1HeaderRight{
  display:flex;
  align-items:center;
  gap:10px;
  min-width:0;
}

/* body（左: チャート / 右: ABC） */
.widget1Body{
  flex:1;
  min-height:0;
  display:grid;
  grid-template-columns:minmax(0, 1fr) 260px;
  gap:12px;
  padding:10px;
}

/* Chart.jsが描画できる高さを必ず確保する */
.widget1ChartWrap{
  min-height:0;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
}

/* ✅ セル高を揃えるため：canvasは “セルの高さ100%” を優先
   （max-height 固定があると、他カードと高さ感がズレる） */
.widget1Canvas{
  width:100% !important;
  height:100% !important;
  display:block;
  max-height:none;          /* ← ここが重要：固定上限を撤去 */
}

/* ABC（凡例） */
.widget1ABC{
  min-height:0;
  overflow:auto;
  font-size:12px;
  line-height:1.2;
  padding-right:4px;
}

.widget1ABCRow{
  display:grid;
  grid-template-columns:22px 1fr auto;
  gap:8px;
  align-items:center;
  padding:8px 0;
  border-bottom:1px solid rgba(51,65,85,.6);
}

.widget1ABCRow .rank{
  font-weight:900;
  opacity:.9;
}

.widget1ABCRow.rank-A .rank{ opacity:1; }
.widget1ABCRow.rank-B .rank{ opacity:.85; }
.widget1ABCRow.rank-C .rank{ opacity:.75; }

/* 凡例の色チップ（グラフ連動） */
.w1chip{
  display:inline-block;
  width:12px;
  height:12px;
  border-radius:4px;
  margin-right:8px;
  vertical-align:middle;
}

/* 右下注記 */
.widget1Note{
  margin-top:10px;
  font-size:12px;
  color:var(--muted);
}

/* 狭い場合は縦並び */
@media (max-width:900px){
  .widget1Body{
    grid-template-columns:1fr;
  }
  .widget1ABC{
    max-height:160px;
  }
}

/* =======================================================
   Mid KPI 2×2：範囲確定（重複定義を廃止してここに統一）
   ======================================================= */

/* 上段エリア（2×2の器）に確実な高さを与える */
.midKpiWrap{
  min-height:0;
  display:flex;
  flex-direction:column;
}

.midTop{
  /* ✅ デスクトップ：ここで上段の“高さ”を確定 */
  flex:0 0 clamp(520px, 52vh, 640px);
  min-height:0;
  display:flex;
}

/* 2×2グリッドはこの高さを使い切る */
#midDash{
  width:100%;
  height:100%;
  min-height:0;

  display:grid;
  gap:12px;

  grid-template-columns:repeat(2, minmax(0, 1fr));
  grid-template-rows:repeat(2, minmax(0, 1fr));
  align-items:stretch;
}

/* セルを必ず埋める */
#midDash > *{
  min-width:0;
  min-height:0;
  height:100%;
}

/* =======================================================
   縦長：1列×4段（portrait / 縦横比でも確実に発火）
   ======================================================= */

@media (orientation: portrait), (max-aspect-ratio: 1/1){
  .midTop{
    flex:0 0 clamp(860px, 78vh, 1100px);
  }

 #midDash .dashSlot{
  min-width:0;
  min-height:0;
  height:100%;
}  #midDash{
    grid-template-columns:1fr;
    grid-template-rows:repeat(4, minmax(0, 1fr));
  }
}

.widget1Canvas{
  max-height: none;
}
