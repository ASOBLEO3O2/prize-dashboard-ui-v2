/* =========================================
   Widget①: 売上 / ステーション 構成比（2重ドーナツ）
   - 左: ドーナツ（canvas）
   - 右: ABC（凡例）
   ========================================= */

.widget1{
  height:100%;
  min-height:0;
  display:flex;
  flex-direction:column;
}

/* header（左：タイトル / 右：拡大 + ドロップダウン） */
.widget1Header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  padding:10px 10px 0;
  min-height:0;
}

.widget1HeaderLeft{
  display:flex;
  align-items:center;
  gap:10px;
  min-width:0;
}

.widget1Title{
  font-weight:900;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

.widget1HeaderRight{
  display:flex;
  align-items:center;
  gap:10px;
  min-width:0;
}

/* body（左: チャート / 右: ABC） */
.widget1Body{
  flex:1;
  min-height:0;
  display:grid;
  grid-template-columns:minmax(0, 1fr) 260px;
  gap:12px;
  padding:10px;
}

/* ★ここが重要：Chart.jsが描画できる高さを必ず確保する */
.widget1ChartWrap{
  min-height:0;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
}

.widget1Canvas{
  width:100% !important;
  height:100% !important;
  display:block;
  /* ドーナツが大きすぎない上限 */
  max-height:280px;
}

/* ABC（凡例） */
.widget1ABC{
  min-height:0;
  overflow:auto;
  font-size:12px;
  line-height:1.2;
  padding-right:4px;
}

.widget1ABCRow{
  display:grid;
  grid-template-columns:22px 1fr auto;
  gap:8px;
  align-items:center;
  padding:8px 0;
  border-bottom:1px solid rgba(51,65,85,.6);
}

.widget1ABCRow .rank{
  font-weight:900;
  opacity:.9;
}

.widget1ABCRow.rank-A .rank{ opacity:1; }
.widget1ABCRow.rank-B .rank{ opacity:.85; }
.widget1ABCRow.rank-C .rank{ opacity:.75; }

/* 凡例の色チップ（グラフ連動） */
.w1chip{
  display:inline-block;
  width:12px;
  height:12px;
  border-radius:4px;
  margin-right:8px;
  vertical-align:middle;
}

/* 右下注記 */
.widget1Note{
  margin-top:10px;
  font-size:12px;
  color:var(--muted);
}

/* 狭い場合は縦並び */
@media (max-width:900px){
  .widget1Body{
    grid-template-columns:1fr;
  }
  .widget1Canvas{
    max-height:260px;
  }
  .widget1ABC{
    max-height:160px;
  }
}

/* ===== Mid KPI 2×2：セルを必ず埋める（外枠の固定） ===== */

.midKpiWrap,
.midTop{
  min-height: 0;
}

/* 2×2 の器：縦方向も使い切る */
#midDash{
  height: 100%;
  min-height: 0;

  display: grid;
  gap: 12px;

  grid-template-columns: repeat(2, minmax(0, 1fr));
  grid-template-rows: repeat(2, minmax(0, 1fr));
  align-items: stretch;
}

/* スロットがセルを埋める */
#midDash > *{
  min-width: 0;
  min-height: 0;
  height: 100%;
}

/* ===== Mid KPI 上段：高さを確定させる（ここが最重要） ===== */

/* container内で midTop が伸びる前提を作る */
.midKpiWrap{
  min-height: 0;
  display: flex;
  flex-direction: column;
}

/* 上段エリアに “確実な高さ” を与える
   - デスクトップではこの範囲で固定（好みで調整OK）
*/
.midTop{
  flex: 0 0 clamp(420px, 52vh, 560px);
  min-height: 0;
  display: flex;
}

/* 2×2 グリッドはこの高さを使い切る */
#midDash{
  width: 100%;
  height: 100%;
  min-height: 0;

  display: grid;
  gap: 12px;

  grid-template-columns: repeat(2, minmax(0, 1fr));
  grid-template-rows: repeat(2, minmax(0, 1fr));
  align-items: stretch;
}

#midDash > *{
  min-width: 0;
  min-height: 0;
  height: 100%;
}
