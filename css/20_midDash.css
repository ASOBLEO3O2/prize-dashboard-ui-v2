/* =======================================================
   Mid KPI（上段）: 2×2 の器を確定させる
   - 初回ロードで canvas が潰れるのを防ぐ
   - 4枠は必ず同じ高さ
   ======================================================= */

.midKpiWrap{
  min-height: 0;
  display: flex;
  flex-direction: column;
}

.midTop{
  /* PC: 上段の高さを確定（ここが基準） */
  flex: 0 0 clamp(520px, 52vh, 640px);
  min-height: 520px;
  min-height: 0;
  display: flex;
}

/* 2×2 グリッド本体 */
#midDash{
  width: 100%;
  height: 100%;
  min-height: 0;

  display: grid;
  gap: 12px;

  grid-template-columns: repeat(2, minmax(0, 1fr));
  grid-template-rows: repeat(2, minmax(0, 1fr));
  align-items: stretch;
}

/* 4スロット（dashPanel）がセルを埋める */
#midDash > .dashPanel{
  min-width: 0;
  min-height: 0;
  height: 100%;

  display: flex; /* card を伸ばすため */
}

/* スロット直下のカードは全面を使う */
#midDash > .dashPanel > .card{
  flex: 1;
  min-height: 0;

  display: flex;
  flex-direction: column;
}

/* カードの body が残りを全部使う（canvasの親） */
#midDash .midPanelBody{
  flex: 1 1 auto;
  min-height: 0;
  position: relative;
  overflow: hidden;
}

/* chartBody も同じ（Scatter/Hist） */
#midDash .chartBody{
  flex: 1 1 auto;
  min-height: 0;
  position: relative;
  overflow: hidden;
}

/* canvas は親に完全追従 */
#midDash canvas{
  width: 100% !important;
  height: 100% !important;
  display: block;
}

/* =======================================================
   縦長（portrait）: 1列×4段にする
   ======================================================= */

@media (orientation: portrait), (max-aspect-ratio: 1/1){
  .midTop{
    flex: 0 0 clamp(860px, 78vh, 1100px);
    min-height: 860px;
  }

  #midDash{
    grid-template-columns: 1fr;
    grid-template-rows: repeat(4, minmax(0, 1fr));
  }
}
